# -*- coding: utf-8 -*-
"""
Created on Wed May  8 12:02:26 2019

@author: HomePc
"""

import gmpy2
import time
p = gmpy2.mpz(34913643629849643161560146864331738406382806269643436321904447557861485515916430179382953792062418771025211011456771640857471991616129220877195100483299577187758988525996181989185930381868296212148482141796325887245584507363445355666895101821003133905784239152928009496838361890713221218867774355577573538209)
g = gmpy2.mpz(25283770137401280063187896690631846170197154807626402300937453141894274093897700479325323498047155532545585446195865008461095472553313156859994564396171011525356095308819486254971966872864993198504368785800994001962196899996176797004060370224277939564415585014448902285105235726348478382588395369010808213538)

rs = gmpy2.random_state(int(1000 * time.time()))

start_time = time.time()
a = gmpy2.mpz_random(rs,p)
print('a=', a)
b = gmpy2.mpz_random(rs,p)
print('b=', b)

A = gmpy2.powmod(g, a, p)
print('A=', A)
B = gmpy2.powmod(g, b, p)
print('B=', B)

KA = gmpy2.powmod(A, b, p)
print('KA=', KA)
KB = gmpy2.powmod(B, a, p)
print('KB=', KB)

if KA == KB:
    print('success in %s seconds' % (time.time() - start_time))
